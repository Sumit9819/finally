<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Video Player</title>
  <style>
    body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; }
    video { width: 100%; height: 100%; object-fit: contain; cursor: pointer; }
  </style>
</head>
<body>
  <video id="player" controls autoplay>
    <source id="videoSource" src="" type="video/mp4">
    Your browser does not support the video tag.
  </video>

  <script>
    const videoId = window.location.pathname.split("/").pop();

    async function loadVideo() {
      try {
        const res = await fetch(`/api/${videoId}`);
        if (!res.ok) throw new Error("Video not found");
        const data = await res.json();

        const player = document.getElementById("player");
        const source = document.getElementById("videoSource");

        source.src = data.video_path;
        player.load();

        // When user clicks video â†’ redirect
        player.addEventListener("click", () => {
          window.location.href = data.redirect_url;
        });

      } catch (err) {
        document.body.innerHTML = "<h2>Video not found</h2>";
      }
    }

    loadVideo();
  </script>
</body>
</html>
